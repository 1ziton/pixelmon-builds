{"version":3,"file":"pixelmon-pikachu-query-tabs.js","sources":["ng://@pixelmon/pikachu/query-tabs/query-tabs.component.ts","ng://@pixelmon/pikachu/query-tabs/query-tabs.module.ts"],"sourcesContent":["/**\n * @Description: ç¨äºå±ç¤ºå½åæ¥è¯¢æ¡ä»¶\n * @Author: zomixi\n * @Date: 2019-05-15 14:42:17\n */\n\nimport { Component, OnInit, Input, Output, EventEmitter, OnChanges, SimpleChanges, ChangeDetectionStrategy } from '@angular/core';\nimport { QueryTab } from './query-tabs.module';\n\n@Component({\n  selector: 'p-queryTabs',\n  templateUrl: './query-tabs.component.html',\n  styleUrls: ['./query-tabs.component.less'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class QueryTabsComponent implements OnInit, OnChanges {\n  @Input() tabs: QueryTab[] = [];\n  @Input() lexicon: { value: any; label: string }[] = []; // è¯å¸\n\n  @Output() tabsChange: EventEmitter<QueryTab[]> = new EventEmitter();\n  @Output() queryChange: EventEmitter<object> = new EventEmitter();\n  @Output() closeTab: EventEmitter<QueryTab> = new EventEmitter();\n\n  // è¿æ»¤è§å\n  @Input() filterRule: (tab: QueryTab) => boolean = tab => {\n    const searchValue = tab.searchValue;\n\n    // æé»è®¤å¼ä¸æç´¢å¼åé»è®¤å¼ç¸ç­\n    if (tab.hasOwnProperty('defaultValue') && searchValue === tab.defaultValue) {\n      return false;\n    }\n    // éæ³åºç¡æ°æ®ç±»å\n    if ([undefined, null, ''].includes(searchValue)) {\n      return false;\n    }\n    // ç©ºæ°ç»\n    if (Array.isArray(searchValue) && !searchValue.length) {\n      return false;\n    }\n    // éè¿æ ¡éªï¼è¿åtrue\n    return true;\n  };\n\n  constructor() {}\n\n  ngOnInit() {}\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.columns) {\n      this.updateQuery();\n    }\n  }\n\n  onClose(tab: QueryTab): void {\n    // æé»è®¤å¼æ¢å¤é»è®¤å¼ï¼æ²¡æåç½®ä¸ºnull\n    tab.searchValue = tab.hasOwnProperty('defaultValue') ? tab.defaultValue : null;\n\n    this.closeTab.emit(tab);\n    this.tabs = [...this.tabs];\n    this.tabsChange.emit(this.tabs);\n  }\n\n  // ç»ä»¶åæ´æ°æ¥è¯¢å¼\n  updateQuery() {\n    const query = {};\n    this.tabs.forEach(tab => {\n      if (tab.showFilter) {\n        query[tab.field] = tab.searchValue;\n      }\n    });\n    this.queryChange.emit(query);\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FilterPipeModule, TranslatePipeModule } from '@pixelmon/theme';\nimport { NgZorroAntdModule } from 'ng-zorro-antd';\nimport { QueryTabsComponent } from './query-tabs.component';\n\n@NgModule({\n  declarations: [QueryTabsComponent],\n  imports: [CommonModule, TranslatePipeModule, FilterPipeModule, NgZorroAntdModule],\n  exports: [CommonModule, TranslatePipeModule, FilterPipeModule, NgZorroAntdModule, QueryTabsComponent],\n})\nexport class QueryTabsModule {}\n\nexport interface QueryTab {\n  title: string;\n  field: string;\n  showFilter?: boolean;\n  searchValue?: any; // æç´¢å¼\n  defaultValue?: any; // é»è®¤å¼\n  displayValue?: any; // å±ç¤ºå¼\n  lexicon?: { value: any; label: string }[]; // è¯å¸\n}\n"],"names":[],"mappings":";;;;;;;;;MAea,kBAAkB;IA4B7B;QA3BS,SAAI,GAAe,EAAE,CAAC;QACtB,YAAO,GAAoC,EAAE,CAAC;;QAE7C,eAAU,GAA6B,IAAI,YAAY,EAAE,CAAC;QAC1D,gBAAW,GAAyB,IAAI,YAAY,EAAE,CAAC;QACvD,aAAQ,GAA2B,IAAI,YAAY,EAAE,CAAC;;QAGvD,eAAU;;;;QAA+B,GAAG;;kBAC7C,WAAW,GAAG,GAAG,CAAC,WAAW;;YAGnC,IAAI,GAAG,CAAC,cAAc,CAAC,cAAc,CAAC,IAAI,WAAW,KAAK,GAAG,CAAC,YAAY,EAAE;gBAC1E,OAAO,KAAK,CAAC;aACd;;YAED,IAAI,CAAC,SAAS,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC,QAAQ,CAAC,WAAW,CAAC,EAAE;gBAC/C,OAAO,KAAK,CAAC;aACd;;YAED,IAAI,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE;gBACrD,OAAO,KAAK,CAAC;aACd;;YAED,OAAO,IAAI,CAAC;SACb,EAAC;KAEc;;;;IAEhB,QAAQ,MAAK;;;;;IAEb,WAAW,CAAC,OAAsB;QAChC,IAAI,OAAO,CAAC,OAAO,EAAE;YACnB,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;KACF;;;;;IAED,OAAO,CAAC,GAAa;;QAEnB,GAAG,CAAC,WAAW,GAAG,GAAG,CAAC,cAAc,CAAC,cAAc,CAAC,GAAG,GAAG,CAAC,YAAY,GAAG,IAAI,CAAC;QAE/E,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACxB,IAAI,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC;QAC3B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KACjC;;;;;IAGD,WAAW;;cACH,KAAK,GAAG,EAAE;QAChB,IAAI,CAAC,IAAI,CAAC,OAAO;;;;QAAC,GAAG;YACnB,IAAI,GAAG,CAAC,UAAU,EAAE;gBAClB,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,WAAW,CAAC;aACpC;SACF,EAAC,CAAC;QACH,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAC9B;;;YA9DF,SAAS,SAAC;gBACT,QAAQ,EAAE,aAAa;gBACvB,srCAA0C;gBAE1C,eAAe,EAAE,uBAAuB,CAAC,MAAM;;aAChD;;;;;mBAEE,KAAK;sBACL,KAAK;yBAEL,MAAM;0BACN,MAAM;uBACN,MAAM;yBAGN,KAAK;;;;IARN,kCAA+B;;IAC/B,qCAAuD;;IAEvD,wCAAoE;;IACpE,yCAAiE;;IACjE,sCAAgE;;IAGhE,wCAiBE;;;;;;;ACzCJ,MAWa,eAAe;;;YAL3B,QAAQ,SAAC;gBACR,YAAY,EAAE,CAAC,kBAAkB,CAAC;gBAClC,OAAO,EAAE,CAAC,YAAY,EAAE,mBAAmB,EAAE,gBAAgB,EAAE,iBAAiB,CAAC;gBACjF,OAAO,EAAE,CAAC,YAAY,EAAE,mBAAmB,EAAE,gBAAgB,EAAE,iBAAiB,EAAE,kBAAkB,CAAC;aACtG;;;;;AAGD,uBAQC;;;IAPC,yBAAc;;IACd,yBAAc;;IACd,8BAAqB;;IACrB,+BAAkB;;IAClB,gCAAmB;;IACnB,gCAAmB;;IACnB,2BAA0C;;;;;;;;;;;;;;;"}